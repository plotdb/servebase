<div><script type="@plotdb/block">var i18nResource;i18nResource={en:{login:"Login",signup:"Sign Up","login successfully":"login successfully",displayname:"display name",forget:"forget password",alt:"or login with",or:"or",contact:"contact us",email:"email",passwd:"password","reset passwd":"Reset Password",required:"requried field","Account exists. Try login":"Account exists. Try login","Password mismatched":"Password mismatched","login failed":"Login failed","signup failed":"Signup failed","Captcha failed":"Captcha failed","Resource issue":"Resource issue",input:{email:{hint:"your email address, as account name",invalid:"invalid email address"},displayname:{hint:"such as 'Paris Hillton'"},passwd:{hint:"at least 8 characters",invalid:{short:"password too short",incorrect:"password incorrect"}}},info:{def:{title:"Sign In",desc:["is your account. If you are the representative of your team, try using","a team-shared","email address.","Some features require you signing in before using."]},sfail:{title:"Sign Up Failed",desc:"You may have signed up before, or there is a typo. You can:",hint:["instead of sign up, try login","try longer password","try login with social accounts.","try with incognito mode without VPN"]},lfail:{title:"Login Failed",desc:"Maybe incorrect email/password, different methods used before or never signed up. You can: ",hint:["try other login methods","check typos in your input","switch to Sign Up and try again","try with incognito mode without VPN"]},fail:{note:["If it keeps failing, you can try with","this link","to sign in with your session reset"]},exceed:{title:"Failed to Sign in",desc:"You have signed in with more devices than we expected. Please logout from other devices and try again.",hint:["If you need to sign out from other device, please click this button:","Sign out from other devices","If you need helps, you can also"]}},tos:{desc:["by sign-in, you agree to our","Terms","and","Privacy Policy"]}},"zh-TW":{login:"登入",signup:"註冊","login successfully":"成功登入",displayname:"顯示名稱",forget:"忘記密碼",alt:"或使用下列登入",or:"或",contact:"與我們聯繫",email:"電子郵件",passwd:"密碼","reset passwd":"重設密碼",required:"不能留白","Account exists. Try login":"帳號存在，請改用登入","Password mismatched":"密碼不符合","login failed":"登入失敗","signup failed":"註冊失敗","Captcha failed":"未通過真人驗證","Resource issue":"載入資源失敗",input:{email:{hint:"您的電子郵件地址做為帳戶名",invalid:"無效的電子郵件"},displayname:{hint:"例如: 王小明"},passwd:{hint:"至少八個字元",invalid:{short:"密碼太短了",incorrect:"密碼不正確"}}},info:{def:{title:"登入服務",desc:["即為您的帳號。若您代表您的團隊註冊，建議您使用一個","團隊可共用","的電子郵件。","登入之後即可進行各種需要帳號才能使用的操作。"]},sfail:{title:"註冊失敗",desc:"您可能先前已經註冊過了，或者您所填的資訊有問題。您可以試著：",hint:["切換至登入模式後再試一次","試著使用更複雜的密碼","嘗試使用社群帳號登入","不使用 VPN 並使用無痕模式註冊"]},lfail:{title:"登入失敗。",desc:"您之前可能用的是別組帳號或密碼、使用不同的登入方式、甚至尚未註冊過。您可以試著：",hint:["換一組帳號、密碼或登入方式","確認您的 email 或密碼沒有打錯","切換至註冊模式後再試一次","不使用 VPN 並使用無痕模式登入"]},fail:{note:["若不斷失敗，亦可嘗試透過","此連結","登入，以重設您的使用階段。"]},exceed:{title:"登入失敗。",desc:"您已在其它裝置登入，登入數量已超過限制，因此您無法在此裝置登入。您可以先登出其它的裝置，然後再試一次。",hint:["若您需要我們協助您登出其它裝置，請點擊下列按鈕：","登出其它所有裝置","若您需要其它任何的協助，亦可"]}},tos:{desc:["登入即代表您同意我們的","用戶條款","與","隱私政策"]}}};var baseImp;baseImp={init:function(e){var n,r,t,u,s,l,i,c,o=this;n=e.ctx,r=e.root,t=e.data,u=e.t;s=n.ldview,l=n.ldnotify,i=n.curegex,c=n.ldform;return servebase.corectx(function(e){var a;a=e.core;return function(e){return e.apply(o.mod=o.mod(import$({core:a,t:u},n)))}(function(){var o=this;this._auth=t.auth;return this._auth.get().then(function(i){var e,n,t;o.global=i;o.ldcv=e={};e.authpanel=new ldcover({root:r,zmgr:a.zmgr});e.authpanel.on("toggle.on",function(){return setTimeout(function(){return n.get("username").focus()},100)});o._tab="login";o._info="default";o.view=n=new s({root:r,action:{keyup:{input:function(e){var n,t;n=e.node,t=e.evt;if(t.keyCode===13){return o.submit()}}},click:{oauth:function(e){var n,t,r;n=e.node;t=((r=i.policy||(i.policy={})).login||(r.login={})).acceptSignup!=="invite"?Promise.resolve():a.ldcvmgr.get({name:"@servebase/auth",path:"invite-token"});return t.then(function(e){e==null&&(e={});return o._auth.oauth({name:n.getAttribute("data-name",{inviteToken:e.inviteToken})})}).then(function(e){debounce(350,function(){return o.info("default")});o.form.reset();o.ldcv.authpanel.set(e);return l.send("success",u("login successfully"))})},submit:function(e){var n;n=e.node;return o.submit()},switch:function(e){var n;n=e.node;return o.tab(n.getAttribute("data-name"))}}},init:{submit:function(e){var n;n=e.node;return o.ldld=new ldloader({root:n})}},handler:{oauths:function(e){var n,t,r;n=e.node;return n.classList.toggle("d-none",!function(){var e,n=[];for(t in e=this.global.oauth){r=e[t];n.push(r)}return n}.call(o).filter(function(e){return e.enabled}).length)},"signin-failed-hint":function(e){var n;n=e.node;return n.classList.toggle("d-none",!o._failedHint)},"signin-failed-hint-text":function(e){var n;n=e.node;return n.innerText=o._failedHintText||""},oauth:function(e){var n;n=e.node;return n.classList.toggle("d-none",!(o.global.oauth[n.getAttribute("data-name")]||{}).enabled)},submit:function(e){var n;n=e.node;return n.classList.toggle("disabled",!o.ready)},"submit-text":function(e){var n;n=e.node;return n.innerText=u(o._tab==="login"?"login":"signup")},displayname:function(e){var n;n=e.node;return n.classList.toggle("d-none",o._tab==="login")},info:function(e){var n,t;n=e.node;t=n.getAttribute("data-name")!==o._info;if(n.classList.contains("d-none")||t){return n.classList.toggle("d-none",t)}n.classList.toggle("d-none",true);return setTimeout(function(){return n.classList.toggle("d-none",t)},0)},switch:function(e){var n,t;n=e.node;t=n.getAttribute("data-name");n.classList.toggle("btn-light",o._tab!==t);n.classList.toggle("border",o._tab!==t);return n.classList.toggle("btn-primary",o._tab===t)}}});o.form=t=new c({names:function(){return["username","password","displayname"]},afterCheck:function(e,n){if(e.username!==1&&!o.isValid.username(n.username.value)){e.username=2}if(e.password!==1){e.password=!n.password.value?1:!o.isValid.password(n.password.value)?2:0}if(o._tab==="login"){return e.displayname=0}else{return e.displayname=!n.displayname.value?1:!!n.displayname.value?0:2}},root:r});return o.form.on("readystatechange",function(e){o.ready=e;return o.view.render("submit")})})})})},interface:function(){var t=this;return function(e,n){e==null&&(e=true);n==null&&(n={});if(n.tab){t.mod.tab(n.tab)}if(n.lock){t.mod.ldcv.authpanel.lock()}if(e){return t.mod.ldcv.authpanel.get()}else{return t.mod.auth.fetch().then(function(e){return this.mod.ldcv.authpanel.set(e)})}}},mod:function(e){var o,n,t,r,a;o=e.core,n=e.ldview,t=e.ldnotify,r=e.curegex,a=e.t;return{tab:function(e){if(/failed/.exec(this._info)){this._info="default"}this._tab=e;return this.view.render()},isValid:{username:function(e){return r.get("email").exec(e)},password:function(e){return e&&e.length>=8}},info:function(e){this._info=e;return this.view.render("info")},submit:function(){var e,r,n,i=this;if(!this.form.ready()){return}this._failedHint=false;this.view.render("signin-failed-hint");e=this.form.values();r=(n={},n.username=e.username,n.password=e.password,n.displayname=e.displayname,n);return this.ldld.on().then(function(){return debounce(1e3)}).then(function(){var e,n,t;e=i.global;return n=((t=e.policy||(e.policy={})).login||(t.login={})).acceptSignup!=="invite"||i._tab!=="signup"?Promise.resolve():o.ldcvmgr.get({name:"@servebase/auth",path:"invite-token"})}).then(function(e){var t;e==null&&(e={});t=function(n){n==null&&(n={});return o.captcha.guard({cb:function(e){import$((r.captcha=e,r),n.inviteToken?{inviteToken:n.inviteToken}:{});return debounce(250).then(function(){return ld$.fetch(i._auth.apiRoot()+""+i._tab,{method:"POST"},{json:r,type:"json"})})}})["catch"](function(n){if(lderror.id(n)!==1043){return Promise.reject(n)}return debounce(250).then(function(){return o.ldcvmgr.get({name:"@servebase/auth",path:"invite-token"}).then(function(e){if(!(e&&e.inviteToken)){return Promise.reject(n)}return t({inviteToken:e.inviteToken})})})})};return t(e.inviteToken?e:{})})["catch"](function(e){if(lderror.id(e)!==1005){return Promise.reject(e)}return ld$.fetch(i._auth.apiRoot()+"reset",{method:"POST"}).then(function(){return i._auth.fetch({renew:true})}).then(function(){return ld$.fetch(i._auth.apiRoot()+""+i._tab,{method:"POST"},{json:r,type:"json"})})}).then(function(n){n==null&&(n={});return i._auth.fetch().then(function(e){if(!n.passwordShouldRenew){return e}return o.ldcvmgr.get({name:"@servebase/auth",path:"passwd-renew"}).then(function(){return e})})})["finally"](function(){return i.ldld.off()}).then(function(e){debounce(350,function(){return i.info("default")});i._failedHint=false;i.view.render();i.form.reset();i.ldcv.authpanel.set(e);t.send("success",a("login successfully"));return e})["catch"](function(e){var n;console.log(e);n=lderror.id(e);if(n>=500&&n<599){return lderror.reject(1007)}if(n===1029){return Promise.reject(e)}if(n===1004){return i.info("login-exceeded")}i._failedHintText=n===1014?a("Account exists. try login"):n===1012||n===1030?a("Password mismatched"):n===1009||n===1010?a("Captcha failed"):n===1041?a("Resource issue"):a(i._tab+" failed");i.info(i._tab+"-failed");i._failedHint=true;i.view.render();i.form.fields.password.value=null;i.form.check({n:"password",now:true});if(!n||(n===1009||n===1010||n===1041)){throw e}})}}}};function import$(e,n){var t={}.hasOwnProperty;for(var r in n)if(t.call(n,r))e[r]=n[r];return e}module.exports=import$({pkg:{name:"auth",version:"0.0.1",path:"base.html",i18n:i18nResource,dependencies:[{name:"ldview",version:"main"},{name:"ldnotify",version:"main"},{name:"ldform",version:"main"},{name:"ldbutton",version:"main",type:"css"},{name:"@loadingio/loading.css",version:"main",path:"lite.min.css"},{name:"ldnotify",version:"main",type:"css",global:true},{name:"curegex",version:"main",path:"curegex.min.js"}]}},baseImp);function import$(n,e){var i={}.hasOwnProperty;for(var a in e)if(i.call(e,a))n[a]=e[a];return n}</script></div>
